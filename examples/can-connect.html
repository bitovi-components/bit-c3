<html>
  <head>
    <title>Line Chart</title>
  </head>
  <body>
    <!-- Template to load -->
    <script type="text/stache" id="demo-html" can-autorender>
      <can-import from="bit-c3" />

      <order-model get-list="{}">
        {{#if isPending}}
          Loading...
        {{else}}
          <bit-c3>
            <bit-c3-data>
              <bit-c3-data-column value="{value.totals}" />
              <bit-c3-data-name key="orders" value="Order volume" />
            </bit-c3-data>
          </bit-c3>
        {{/if}}
      </order-model>
    </script>

    <!-- Loading Script -->
    <script src="../node_modules/steal/steal.js" id="demo-source" main="can/view/autorender/">
      import $ from "jquery";
      import can from "can";
      import superMap from 'can-connect/can/super-map/';
      import tag from 'can-connect/can/tag/';
      // import fixture from 'can-connect/fixture/';

      const orderData = [
        { id: 0, total: 30 },
        { id: 1, total: 200 },
        { id: 2, total: 100 },
        { id: 3, total: 400 },
        { id: 4, total: 150 },
        { id: 5, total: 250 }
      ];

      // fixture('GET /api/orders', function() {
      //   return orderData;
      // });

      const Order = can.Map.extend({});

      Order.List = can.List.extend({
        Map: Order
      }, {
        totals() {
          let totals = ['Order total'];
          this.each(order => totals.push(order.total));
          return totals;
        }
      });

      const orderConnection = superMap({
        url: '/api/orders',
        idProp: 'short',
        Map: Order,
        List: Order.List,
        name: 'orders'
      });

      tag('order-model', orderConnection);

      var vm = $("#demo-html").viewModel();
      vm.attr('value', new Order.List(orderData));
    </script>
  </body>
</html>
